{% extends 'base_layout.html' %}
{% load staticfiles %}
{% block content %}

    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            {{ obj.name }}

        </h1>
        <ol class="breadcrumb">
            <li><a href="{% url 'kurye:kullanıcı-dashboard' %}"><i class="fa fa-dashboard"></i> Anasayfa</a></li>

        </ol>
    </section>

    <!-- Main content -->
    <section class="content">
        <!-- Small boxes (Stat box) -->
        <div class="row">
            <div class="col-lg-3 col-xs-6">
                <!-- small box -->
                <div class="small-box bg-aqua">
                    <div class="inner">
                        <h3>{{ requests | length }}</h3>

                        <p>TOPLAM TALEP EDİLEN KURYE</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-bag"></i>
                    </div>
                    <a href="" class="small-box-footer"><i
                            class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-xs-6">
                <!-- small box -->
                <div class="small-box bg-orange">
                    <div class="inner">
                        <h3>{{ canceled_tasks | length }}</h3>

                        <p>İPTAL EDİLEN TALEP </p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer">Bekleyen Görevler <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-xs-6">
                <!-- small box -->
                <div class="small-box bg-green">
                    <div class="inner">
                        <h3>{{ completed_tasks | length }}</h3>

                        <p>TAMAMLANAN TALEP</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    <a href="{% url 'kurye:kullanıcının biten talepleri' %}" class="small-box-footer">Tamamlanan
                        Görevler <i
                                class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-xs-6">
                <!-- small box -->
                <div class="small-box bg-red">
                    <div class="inner">
                        <h3>{{ unsuccessful_tasks | length }}</h3>

                        <p>BAŞARISIZ TALEP</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-pie-graph"></i>
                    </div>
                    <a href="#" class="small-box-footer">Başarısız <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
        </div>


        <div class="row">
            <div class="col-lg-6 col-xs-12">
                <div class="box box-danger">
                    <div class="box-header with-border">
                        <h3 class="box-title">Son Görevler</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="table-responsive">
                            <table class="table no-margin">
                                <thead>
                                <tr>
                                    <th>Görev Numarası</th>
                                    <th>Sipariş Tutarı</th>
                                    <th>Kurye</th>
                                    <th>Teslim Tarih/Zaman</th>
                                    <th>Durumu</th>

                                </tr>
                                </thead>
                                <tbody>


                                {% for x in tasks %}
                                    {% for task in x %}
                                        <tr>
                                            <td>{{ task.pk }}</td>
                                            <td>{{ task.task.request.totalPrice }}</td>
                                            <td>{{ task.task.courier.courier.user.first_name }} {{ task.task.courier.courier.user.last_name }}</td>
                                            <td>{{ task.task.request.exitDate }}
                                                - {{ task.task.request.exitTime }}</td>
                                            <td><span
                                                    class="label label-warning">{{ task.task_situation.name }}</span>
                                            </td>

                                        </tr>
                                    {% endfor %}
                                {% endfor %}


                                </tbody>
                            </table>
                        </div>
                        <!-- /.table-responsive -->
                    </div>
                    <!-- /.box-body -->
                    <div class="box-footer clearfix">
                        <a href="{% url 'kurye:yeni kullanıcıyla talep olustur' %}"
                           class="btn btn-sm btn-default btn-flat pull-left">Yeni Müşteri
                            Talep Oluştur</a>
                        <a href="{% url 'kurye:kayıtlı kullanıcıyla talep olustur' %}"
                           class="btn btn-sm btn-default btn-flat pull-right">Kayıtlı
                            Müşteri Talep Oluştur</a>

                    </div>
                    <!-- /.box-footer -->


                </div>


            </div>
            <div class="col-lg-6 col-xs-12">
                <div class="box box-success">
                    <div class="box-header with-border">
                        <h3 class="box-title">Müşteriler</h3>

                        <div class="box-tools pull-right" style="margin-top: 4px">
                            <span class="label label-warning">En Çok Sipariş Veren 10 Müşteri</span>

                        </div>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="table-responsive">
                            <table class="table no-margin">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Ad Soyad</th>
                                    <th>Telefon</th>

                                </tr>
                                </thead>
                                <tbody>


                                {% for customer in active_customers %}

                                    <tr>
                                        <td>{{ forloop.counter }}</td>
                                        <td>{{ customer.customer }}</td>
                                        <td>{{ customer.customer.phone}}</td>
                                        <td>{{ customer.count }} kere sipariş verdi </td>

                                    </tr>

                                {% endfor %}


                                </tbody>
                            </table>
                        </div>
                        <!-- /.table-responsive -->
                    </div>
                    <!-- /.box-body -->
                    <div class="box-footer text-center">
                        <a href="{% url 'kurye:musteri listesi' %}" class="uppercase">Tüm Müşteriler</a>
                    </div>
                    <!-- /.box-footer -->
                </div>
            </div>

        </div>


    </section>

    <!-- /.row -->

{% endblock %}